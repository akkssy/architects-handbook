<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-File Refactoring - Implementation Details</title>
    <style>
        :root {
            --primary: #7c3aed;
            --primary-light: #a78bfa;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --code-bg: #1e1e1e;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-radius: 16px;
            margin-bottom: 2rem;
        }
        header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
        header p { opacity: 0.9; font-size: 1.1rem; }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 1rem;
        }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem; }
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }
        .card h2 {
            color: var(--primary);
            font-size: 1.25rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .card h3 { font-size: 1rem; margin: 1rem 0 0.5rem; color: var(--text); }
        .card ul { padding-left: 1.25rem; }
        .card li { margin: 0.5rem 0; color: var(--text-muted); }
        .card li strong { color: var(--text); }
        code {
            background: var(--code-bg);
            color: #d4d4d4;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-size: 0.85rem;
        }
        pre {
            background: var(--code-bg);
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin: 1rem 0;
        }
        pre code { background: none; padding: 0; }
        .highlight { color: #9cdcfe; }
        .string { color: #ce9178; }
        .keyword { color: #569cd6; }
        .comment { color: #6a9955; }
        .tag { display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.2rem 0.5rem;
               background: #ecfdf5; color: #059669; border-radius: 4px; font-size: 0.75rem; }
        .tag.new { background: #dbeafe; color: #2563eb; }
        .tag.modified { background: #fef3c7; color: #d97706; }
        .full-width { grid-column: 1 / -1; }
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            padding: 1.5rem;
            background: #f1f5f9;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .flow-box {
            padding: 0.75rem 1.25rem;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 8px;
            font-weight: 500;
            text-align: center;
        }
        .flow-arrow { font-size: 1.5rem; color: var(--primary); }
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--border); }
        th { background: #f8fafc; font-weight: 600; }
        .file-tree { font-family: monospace; font-size: 0.9rem; }
        .file-tree .folder { color: var(--primary); }
        .file-tree .file { color: var(--text-muted); }
        .change-type { display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.2rem 0.6rem;
                       border-radius: 4px; font-size: 0.8rem; font-weight: 500; }
        .change-type.modify { background: #dbeafe; color: #2563eb; }
        .change-type.create { background: #dcfce7; color: #16a34a; }
        .change-type.delete { background: #fee2e2; color: #dc2626; }
        .change-type.rename { background: #fef3c7; color: #d97706; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîÑ Multi-File Refactoring</h1>
            <p>Project-Wide Refactoring & Symbol Renaming</p>
            <span class="badge">AI Code Assistant v0.4.0</span>
        </header>

        <div class="grid">
            <!-- Overview Card -->
            <div class="card">
                <h2>üìã Feature Overview</h2>
                <p>Coordinate <strong>AI-powered changes</strong> across multiple files with dependency tracking and backup support.</p>
                <h3>Key Capabilities</h3>
                <ul>
                    <li><strong>Analyze</strong> - Understand codebase structure</li>
                    <li><strong>Plan</strong> - Create coordinated change plans</li>
                    <li><strong>Preview</strong> - Dry-run mode to review changes</li>
                    <li><strong>Apply</strong> - Execute changes with backup</li>
                    <li><strong>Rename</strong> - Symbol renaming across files</li>
                </ul>
            </div>

            <!-- Architecture Card -->
            <div class="card">
                <h2>üèóÔ∏è Architecture</h2>
                <div class="flow-diagram">
                    <div class="flow-box">Instruction</div>
                    <span class="flow-arrow">‚Üí</span>
                    <div class="flow-box">Analyzer<br><small>(LLM)</small></div>
                    <span class="flow-arrow">‚Üí</span>
                    <div class="flow-box">Change Plan</div>
                    <span class="flow-arrow">‚Üí</span>
                    <div class="flow-box">Apply</div>
                </div>
                <div class="flow-diagram">
                    <div class="flow-box">Read Files</div>
                    <span class="flow-arrow">‚Üí</span>
                    <div class="flow-box">Generate Diffs</div>
                    <span class="flow-arrow">‚Üí</span>
                    <div class="flow-box">Create Backup</div>
                    <span class="flow-arrow">‚Üí</span>
                    <div class="flow-box">Write Files</div>
                </div>
            </div>

            <!-- New Files Card -->
            <div class="card">
                <h2>üìÅ New Files Created</h2>
                <div class="file-tree">
                    <p><span class="folder">üìÇ src/ai_code_assistant/refactor/</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îú‚îÄ‚îÄ __init__.py</span> <span class="tag new">NEW</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îú‚îÄ‚îÄ prompts.py</span> <span class="tag new">NEW</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îú‚îÄ‚îÄ change_plan.py</span> <span class="tag new">NEW</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îú‚îÄ‚îÄ analyzer.py</span> <span class="tag new">NEW</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îî‚îÄ‚îÄ multi_file_editor.py</span> <span class="tag new">NEW</span></p>
                    <br>
                    <p><span class="folder">üìÇ tests/</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îî‚îÄ‚îÄ test_refactor.py</span> <span class="tag new">NEW</span></p>
                    <br>
                    <p><span class="folder">üìÇ docs/</span></p>
                    <p>&nbsp;&nbsp;<span class="file">‚îî‚îÄ‚îÄ REFACTOR_FEATURE.md</span> <span class="tag new">NEW</span></p>
                </div>
            </div>

            <!-- Modified Files Card -->
            <div class="card">
                <h2>‚úèÔ∏è Modified Files</h2>
                <table>
                    <tr>
                        <th>File</th>
                        <th>Changes</th>
                    </tr>
                    <tr>
                        <td><code>config.py</code></td>
                        <td>Added RefactorConfig class</td>
                    </tr>
                    <tr>
                        <td><code>config.yaml</code></td>
                        <td>Added refactor settings section</td>
                    </tr>
                    <tr>
                        <td><code>cli.py</code></td>
                        <td>Added refactor, rename commands</td>
                    </tr>
                    <tr>
                        <td><code>ARCHITECTURE.md</code></td>
                        <td>Added refactor module documentation</td>
                    </tr>
                </table>
            </div>

            <!-- Change Types Card -->
            <div class="card">
                <h2>üîÄ Change Types</h2>
                <p>The refactoring system supports four types of file changes:</p>
                <table>
                    <tr>
                        <th>Type</th>
                        <th>Icon</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="change-type modify">MODIFY</span></td>
                        <td>üìù</td>
                        <td>Modify existing file content</td>
                    </tr>
                    <tr>
                        <td><span class="change-type create">CREATE</span></td>
                        <td>‚ú®</td>
                        <td>Create a new file</td>
                    </tr>
                    <tr>
                        <td><span class="change-type delete">DELETE</span></td>
                        <td>üóëÔ∏è</td>
                        <td>Delete an existing file</td>
                    </tr>
                    <tr>
                        <td><span class="change-type rename">RENAME</span></td>
                        <td>üìõ</td>
                        <td>Rename or move a file</td>
                    </tr>
                </table>
            </div>

            <!-- CLI Commands Card -->
            <div class="card full-width">
                <h2>üíª New CLI Commands</h2>

                <h3>Refactor Command</h3>
                <pre><code><span class="comment"># Add type hints to all Python files</span>
ai-assist refactor <span class="string">"Add type hints to all functions"</span>

<span class="comment"># Refactor with file pattern</span>
ai-assist refactor <span class="string">"Rename User class to Account"</span> -p <span class="string">"**/*.py"</span>

<span class="comment"># Preview changes without applying (dry run)</span>
ai-assist refactor <span class="string">"Extract database logic to repository"</span> --dry-run

<span class="comment"># Refactor specific directory</span>
ai-assist refactor <span class="string">"Add logging to all endpoints"</span> -d ./src/api</code></pre>

                <h3>Rename Command</h3>
                <pre><code><span class="comment"># Rename a class across the codebase</span>
ai-assist rename UserService AccountService --type class

<span class="comment"># Rename a function</span>
ai-assist rename get_user fetch_user --type function -p <span class="string">"**/*.py"</span>

<span class="comment"># Preview rename without applying</span>
ai-assist rename API_KEY API_SECRET --type variable --dry-run</code></pre>
            </div>

            <!-- Options Card -->
            <div class="card">
                <h2>‚öôÔ∏è Command Options</h2>
                <h3>Refactor Options</h3>
                <table>
                    <tr><th>Option</th><th>Description</th></tr>
                    <tr><td><code>--files, -f</code></td><td>Specific files to include</td></tr>
                    <tr><td><code>--pattern, -p</code></td><td>Glob pattern (e.g., **/*.py)</td></tr>
                    <tr><td><code>--directory, -d</code></td><td>Directory to search</td></tr>
                    <tr><td><code>--dry-run</code></td><td>Preview without applying</td></tr>
                    <tr><td><code>--no-confirm</code></td><td>Skip confirmation</td></tr>
                    <tr><td><code>--no-backup</code></td><td>Don't create backup</td></tr>
                    <tr><td><code>--format</code></td><td>Output: console, json</td></tr>
                </table>
            </div>

            <!-- Configuration Card -->
            <div class="card">
                <h2>üîß Configuration</h2>
                <pre><code><span class="comment"># config.yaml - Refactor Settings</span>
<span class="keyword">refactor:</span>
  <span class="comment"># Max files in one operation</span>
  <span class="highlight">max_files:</span> <span class="string">20</span>

  <span class="comment"># Max file size to include (KB)</span>
  <span class="highlight">max_file_size_kb:</span> <span class="string">500</span>

  <span class="comment"># Create backup before changes</span>
  <span class="highlight">create_backup:</span> <span class="string">true</span>

  <span class="comment"># Require confirmation</span>
  <span class="highlight">require_confirmation:</span> <span class="string">true</span>

  <span class="comment"># Show plan before execution</span>
  <span class="highlight">show_plan:</span> <span class="string">true</span></code></pre>
            </div>

            <!-- Key Classes Card -->
            <div class="card">
                <h2>üß© Key Classes</h2>
                <table>
                    <tr><th>Class</th><th>Purpose</th></tr>
                    <tr><td><code>MultiFileEditor</code></td><td>Main coordinator for multi-file operations</td></tr>
                    <tr><td><code>RefactorAnalyzer</code></td><td>Analyzes codebase to create change plans</td></tr>
                    <tr><td><code>ChangePlan</code></td><td>Represents a complete refactoring plan</td></tr>
                    <tr><td><code>FileChange</code></td><td>Individual file change with type and content</td></tr>
                    <tr><td><code>ChangeType</code></td><td>Enum: MODIFY, CREATE, DELETE, RENAME</td></tr>
                    <tr><td><code>RefactorResult</code></td><td>Result with statistics and status</td></tr>
                </table>
            </div>

            <!-- Features Card -->
            <div class="card">
                <h2>‚ú® Key Features</h2>
                <ul>
                    <li><strong>Dependency Tracking</strong> - Changes ordered based on dependencies</li>
                    <li><strong>Backup Support</strong> - Timestamped backup directory created</li>
                    <li><strong>Dry Run Mode</strong> - Preview all changes without modifying files</li>
                    <li><strong>Confirmation Prompt</strong> - User confirmation before applying</li>
                    <li><strong>JSON Output</strong> - Machine-readable output for integration</li>
                    <li><strong>Priority Ordering</strong> - High priority changes applied first</li>
                    <li><strong>Error Recovery</strong> - Partial failures don't stop entire operation</li>
                </ul>
            </div>

            <!-- Test Results Card -->
            <div class="card">
                <h2>‚úÖ Test Results</h2>
                <p style="color: var(--success); font-weight: 600; font-size: 1.2rem;">26 tests passed</p>

                <h3>Test Coverage</h3>
                <ul>
                    <li><strong>TestFileChange</strong> - 7 tests</li>
                    <li><strong>TestChangePlan</strong> - 5 tests</li>
                    <li><strong>TestRefactorResult</strong> - 5 tests</li>
                    <li><strong>TestRefactorAnalyzer</strong> - 5 tests</li>
                    <li><strong>TestMultiFileEditor</strong> - 4 tests</li>
                </ul>

                <pre><code>pytest tests/test_refactor.py -v
<span class="comment"># 26 passed in 1.91s</span></code></pre>
            </div>

            <!-- Example Output Card -->
            <div class="card full-width">
                <h2>üöÄ Example Usage</h2>
                <pre><code><span class="comment"># 1. Run refactoring with dry-run first</span>
$ ai-assist refactor <span class="string">"Add type hints to all functions"</span> -p <span class="string">"**/*.py"</span> --dry-run

<span class="highlight">Multi-File Refactoring</span>
Instruction: Add type hints to all functions
Files in scope: 12

<span class="highlight">Refactoring Plan</span>
Summary: Add type annotations to function parameters and return types
Complexity: medium
Files affected: 8

<span class="keyword">Risks:</span>
  ‚ö† May require updating dependent code

<span class="highlight">Planned Changes:</span>
  üìù [modify] src/utils.py
     Add type hints to 5 functions
  üìù [modify] src/handlers.py
     Add type hints to 3 functions
  üìù [modify] src/models.py
     Add type hints to 7 functions

<span class="comment">Dry run - no changes applied</span>

<span class="comment"># 2. Apply the changes</span>
$ ai-assist refactor <span class="string">"Add type hints to all functions"</span> -p <span class="string">"**/*.py"</span>

<span class="string">‚úì Refactoring complete!</span>
  Files changed: 8
  Additions: +45
  Deletions: -12

<span class="comment">Backup saved: .refactor_backup_20260124_143022</span></code></pre>
            </div>
        </div>

        <footer style="text-align: center; padding: 2rem; color: var(--text-muted);">
            <p>AI Code Assistant - Multi-File Refactoring Feature</p>
            <p>Implementation Date: 2026-01-24</p>
        </footer>
    </div>
</body>
</html>

